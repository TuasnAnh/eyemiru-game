{"ast":null,"code":"var createBasketRenderSystem=function createBasketRenderSystem(){var basketFront,basketBack;var F_HEIGHT,B_HEIGHT;var productInfos=[];var collectionPosition=[];return{init:function init(_ref,_ref2){var basketState=_ref.basketState;var width=_ref2.width,assets=_ref2.assets,productInBasketTex=_ref2.productInBasketTex;var atlas=assets.gameAssets;basketFront=atlas.findRegion(\"basket_front\",-1);basketBack=atlas.findRegion(\"basket_back\",-1);F_HEIGHT=basketState.width*basketFront.height/basketFront.width;B_HEIGHT=basketState.width*basketBack.height/basketBack.width;// collection infos\nvar P_WIDTH=width/8;for(var i=0;i<productInBasketTex.length;i++){var P_HEIGHT=P_WIDTH*productInBasketTex[i].image.height/productInBasketTex[i].image.width;productInfos.push({tex:productInBasketTex[i].image,width:P_WIDTH,height:P_HEIGHT});}},update:function update(delta,_ref3,_ref4){var basketState=_ref3.basketState,collection=_ref3.collection;var batch=_ref4.batch,width=_ref4.width,height=_ref4.height,camera=_ref4.camera;collectionPosition=[{x:basketState.x-productInfos[0].width*0.9,y:basketState.y-basketState.height*1.4},{x:basketState.x-productInfos[1].width*0.1,y:basketState.y-basketState.height*1.3},{x:basketState.x-productInfos[2].width*0.45,y:basketState.y-basketState.height*1.45}];batch.setProjection(camera.combined);batch.begin();batch.setColor(1,1,1,1);basketBack.draw(batch,basketState.x-basketState.width/2,basketState.y-B_HEIGHT,basketState.width,B_HEIGHT);// draw collection\nfor(var i=collection.length-1;i>=0;i--){if(collection[i].enable){productInfos[i].tex.draw(batch,collectionPosition[i].x,collectionPosition[i].y,productInfos[i].width,productInfos[i].height);}}basketFront.draw(batch,basketState.x-basketState.width/2,basketState.y-F_HEIGHT,basketState.width,F_HEIGHT);batch.end();}};};export default createBasketRenderSystem;","map":{"version":3,"sources":["E:/game-project/eyemiru/src/systems/BasketRenderSystem.js"],"names":["createBasketRenderSystem","basketFront","basketBack","F_HEIGHT","B_HEIGHT","productInfos","collectionPosition","init","basketState","width","assets","productInBasketTex","atlas","gameAssets","findRegion","height","P_WIDTH","i","length","P_HEIGHT","image","push","tex","update","delta","collection","batch","camera","x","y","setProjection","combined","begin","setColor","draw","enable","end"],"mappings":"AAAA,GAAMA,CAAAA,wBAAwB,CAAG,QAA3BA,CAAAA,wBAA2B,EAAM,CACrC,GAAIC,CAAAA,WAAJ,CAAiBC,UAAjB,CACA,GAAIC,CAAAA,QAAJ,CAAcC,QAAd,CACA,GAAIC,CAAAA,YAAY,CAAG,EAAnB,CACA,GAAIC,CAAAA,kBAAkB,CAAG,EAAzB,CACA,MAAO,CACLC,IADK,0BACwD,IAAtDC,CAAAA,WAAsD,MAAtDA,WAAsD,IAArCC,CAAAA,KAAqC,OAArCA,KAAqC,CAA9BC,MAA8B,OAA9BA,MAA8B,CAAtBC,kBAAsB,OAAtBA,kBAAsB,CAC3D,GAAIC,CAAAA,KAAK,CAAGF,MAAM,CAACG,UAAnB,CACAZ,WAAW,CAAGW,KAAK,CAACE,UAAN,CAAiB,cAAjB,CAAiC,CAAC,CAAlC,CAAd,CACAZ,UAAU,CAAGU,KAAK,CAACE,UAAN,CAAiB,aAAjB,CAAgC,CAAC,CAAjC,CAAb,CAEAX,QAAQ,CAAIK,WAAW,CAACC,KAAZ,CAAoBR,WAAW,CAACc,MAAjC,CAA2Cd,WAAW,CAACQ,KAAlE,CACAL,QAAQ,CAAII,WAAW,CAACC,KAAZ,CAAoBP,UAAU,CAACa,MAAhC,CAA0Cb,UAAU,CAACO,KAAhE,CAEA;AACA,GAAMO,CAAAA,OAAO,CAAGP,KAAK,CAAG,CAAxB,CAEA,IAAK,GAAIQ,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGN,kBAAkB,CAACO,MAAvC,CAA+CD,CAAC,EAAhD,CAAoD,CAClD,GAAME,CAAAA,QAAQ,CACXH,OAAO,CAAGL,kBAAkB,CAACM,CAAD,CAAlB,CAAsBG,KAAtB,CAA4BL,MAAvC,CACAJ,kBAAkB,CAACM,CAAD,CAAlB,CAAsBG,KAAtB,CAA4BX,KAF9B,CAIAJ,YAAY,CAACgB,IAAb,CAAkB,CAChBC,GAAG,CAAEX,kBAAkB,CAACM,CAAD,CAAlB,CAAsBG,KADX,CAEhBX,KAAK,CAAEO,OAFS,CAGhBD,MAAM,CAAEI,QAHQ,CAAlB,EAKD,CACF,CAvBI,CAyBLI,MAzBK,iBA0BHC,KA1BG,aA6BH,IAFEhB,CAAAA,WAEF,OAFEA,WAEF,CAFeiB,UAEf,OAFeA,UAEf,IADEC,CAAAA,KACF,OADEA,KACF,CADSjB,KACT,OADSA,KACT,CADgBM,MAChB,OADgBA,MAChB,CADwBY,MACxB,OADwBA,MACxB,CACArB,kBAAkB,CAAG,CACnB,CACEsB,CAAC,CAAEpB,WAAW,CAACoB,CAAZ,CAAgBvB,YAAY,CAAC,CAAD,CAAZ,CAAgBI,KAAhB,CAAwB,GAD7C,CAEEoB,CAAC,CAAErB,WAAW,CAACqB,CAAZ,CAAgBrB,WAAW,CAACO,MAAZ,CAAqB,GAF1C,CADmB,CAKnB,CACEa,CAAC,CAAEpB,WAAW,CAACoB,CAAZ,CAAgBvB,YAAY,CAAC,CAAD,CAAZ,CAAgBI,KAAhB,CAAwB,GAD7C,CAEEoB,CAAC,CAAErB,WAAW,CAACqB,CAAZ,CAAgBrB,WAAW,CAACO,MAAZ,CAAqB,GAF1C,CALmB,CASnB,CACEa,CAAC,CAAEpB,WAAW,CAACoB,CAAZ,CAAgBvB,YAAY,CAAC,CAAD,CAAZ,CAAgBI,KAAhB,CAAwB,IAD7C,CAEEoB,CAAC,CAAErB,WAAW,CAACqB,CAAZ,CAAgBrB,WAAW,CAACO,MAAZ,CAAqB,IAF1C,CATmB,CAArB,CAeAW,KAAK,CAACI,aAAN,CAAoBH,MAAM,CAACI,QAA3B,EACAL,KAAK,CAACM,KAAN,GACAN,KAAK,CAACO,QAAN,CAAe,CAAf,CAAkB,CAAlB,CAAqB,CAArB,CAAwB,CAAxB,EAEA/B,UAAU,CAACgC,IAAX,CACER,KADF,CAEElB,WAAW,CAACoB,CAAZ,CAAgBpB,WAAW,CAACC,KAAZ,CAAoB,CAFtC,CAGED,WAAW,CAACqB,CAAZ,CAAgBzB,QAHlB,CAIEI,WAAW,CAACC,KAJd,CAKEL,QALF,EAQA;AACA,IAAK,GAAIa,CAAAA,CAAC,CAAGQ,UAAU,CAACP,MAAX,CAAoB,CAAjC,CAAoCD,CAAC,EAAI,CAAzC,CAA4CA,CAAC,EAA7C,CAAiD,CAC/C,GAAIQ,UAAU,CAACR,CAAD,CAAV,CAAckB,MAAlB,CAA0B,CACxB9B,YAAY,CAACY,CAAD,CAAZ,CAAgBK,GAAhB,CAAoBY,IAApB,CACER,KADF,CAEEpB,kBAAkB,CAACW,CAAD,CAAlB,CAAsBW,CAFxB,CAGEtB,kBAAkB,CAACW,CAAD,CAAlB,CAAsBY,CAHxB,CAIExB,YAAY,CAACY,CAAD,CAAZ,CAAgBR,KAJlB,CAKEJ,YAAY,CAACY,CAAD,CAAZ,CAAgBF,MALlB,EAOD,CACF,CAEDd,WAAW,CAACiC,IAAZ,CACER,KADF,CAEElB,WAAW,CAACoB,CAAZ,CAAgBpB,WAAW,CAACC,KAAZ,CAAoB,CAFtC,CAGED,WAAW,CAACqB,CAAZ,CAAgB1B,QAHlB,CAIEK,WAAW,CAACC,KAJd,CAKEN,QALF,EAQAuB,KAAK,CAACU,GAAN,GACD,CA/EI,CAAP,CAiFD,CAtFD,CAwFA,cAAepC,CAAAA,wBAAf","sourcesContent":["const createBasketRenderSystem = () => {\r\n  let basketFront, basketBack;\r\n  let F_HEIGHT, B_HEIGHT;\r\n  let productInfos = [];\r\n  let collectionPosition = [];\r\n  return {\r\n    init({ basketState }, { width, assets, productInBasketTex }) {\r\n      let atlas = assets.gameAssets;\r\n      basketFront = atlas.findRegion(\"basket_front\", -1);\r\n      basketBack = atlas.findRegion(\"basket_back\", -1);\r\n\r\n      F_HEIGHT = (basketState.width * basketFront.height) / basketFront.width;\r\n      B_HEIGHT = (basketState.width * basketBack.height) / basketBack.width;\r\n\r\n      // collection infos\r\n      const P_WIDTH = width / 8;\r\n\r\n      for (let i = 0; i < productInBasketTex.length; i++) {\r\n        const P_HEIGHT =\r\n          (P_WIDTH * productInBasketTex[i].image.height) /\r\n          productInBasketTex[i].image.width;\r\n\r\n        productInfos.push({\r\n          tex: productInBasketTex[i].image,\r\n          width: P_WIDTH,\r\n          height: P_HEIGHT,\r\n        });\r\n      }\r\n    },\r\n\r\n    update(\r\n      delta,\r\n      { basketState, collection },\r\n      { batch, width, height, camera }\r\n    ) {\r\n      collectionPosition = [\r\n        {\r\n          x: basketState.x - productInfos[0].width * 0.9,\r\n          y: basketState.y - basketState.height * 1.4,\r\n        },\r\n        {\r\n          x: basketState.x - productInfos[1].width * 0.1,\r\n          y: basketState.y - basketState.height * 1.3,\r\n        },\r\n        {\r\n          x: basketState.x - productInfos[2].width * 0.45,\r\n          y: basketState.y - basketState.height * 1.45,\r\n        },\r\n      ];\r\n\r\n      batch.setProjection(camera.combined);\r\n      batch.begin();\r\n      batch.setColor(1, 1, 1, 1);\r\n\r\n      basketBack.draw(\r\n        batch,\r\n        basketState.x - basketState.width / 2,\r\n        basketState.y - B_HEIGHT,\r\n        basketState.width,\r\n        B_HEIGHT\r\n      );\r\n\r\n      // draw collection\r\n      for (let i = collection.length - 1; i >= 0; i--) {\r\n        if (collection[i].enable) {\r\n          productInfos[i].tex.draw(\r\n            batch,\r\n            collectionPosition[i].x,\r\n            collectionPosition[i].y,\r\n            productInfos[i].width,\r\n            productInfos[i].height\r\n          );\r\n        }\r\n      }\r\n\r\n      basketFront.draw(\r\n        batch,\r\n        basketState.x - basketState.width / 2,\r\n        basketState.y - F_HEIGHT,\r\n        basketState.width,\r\n        F_HEIGHT\r\n      );\r\n\r\n      batch.end();\r\n    },\r\n  };\r\n};\r\n\r\nexport default createBasketRenderSystem;\r\n"]},"metadata":{},"sourceType":"module"}