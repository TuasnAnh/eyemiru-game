{"ast":null,"code":"import \"./index.css\";\nimport { createGameLoop, createBatch, loadTexture, loadAtlas, createViewport, fillRect } from \"gdxjs\";\nimport createWhiteText from \"gl-white-texture\";\nimport loadFontFile from \"./utils/loadFontFile\";\nimport createInstructionScreenSystem from \"./screens/InstructionScreen\";\n\nconst init = async () => {\n  const canvas = document.getElementById(\"main\");\n  const width = 47;\n  const height = 100;\n  const viewport = createViewport(canvas, width, height);\n  const camera = viewport.getCamera();\n  const gl = viewport.getContext();\n  const batch = createBatch(gl);\n  const whiteTex = createWhiteText(gl);\n  const Game = {\n    score: 0,\n    width,\n    height,\n    canvas,\n    gl,\n    batch,\n    camera,\n    whiteTex,\n    viewport,\n\n    setCurrentScreen(screen) {\n      if (Game.currentScreen) {\n        Game.currentScreen.destroy();\n      }\n\n      Game.currentScreen = screen;\n    }\n\n  };\n  const foxLogo = await loadTexture(gl, \"./assets/logo.png\");\n  const LOGO_WIDTH = width / 1.8;\n  const LOGO_HEIGHT = LOGO_WIDTH * foxLogo.height / foxLogo.width;\n  let counter = 0;\n  const numOfAssets = 10;\n\n  const draw = () => {\n    batch.setProjection(camera.combined);\n    batch.begin();\n    batch.setColor(255 / 255, 114 / 255, 22 / 255, 1);\n    fillRect(batch, whiteTex, 0, 0, width, height);\n    batch.setColor(1, 1, 1, 1);\n    fillRect(batch, foxLogo, width / 2 - LOGO_WIDTH / 2, height * 0.8 / 3, LOGO_WIDTH, LOGO_HEIGHT);\n    batch.setColor(1, 1, 1, 1);\n    fillRect(batch, whiteTex, width / 2 - width / (1.45 * 2), height * 2.5 / 4 - height / 50, width / 1.45, height / 25);\n    batch.setColor(255 / 255, 114 / 255, 22 / 255, 1);\n    fillRect(batch, whiteTex, width / 2 - width / 3, height * 2.5 / 4 - height / 60, width / 1.5, height / 30);\n    batch.setColor(1, 1, 1, 1);\n    let ratio = counter / numOfAssets;\n    fillRect(batch, whiteTex, width / 2 - width / (1.55 * 2), height * 2.5 / 4 - height / 80, width / 1.55 * ratio, height / 40);\n    batch.end();\n  };\n\n  const doAndCount = promise => promise.then(result => {\n    // draw();\n    counter += 1;\n    return result;\n  });\n\n  const [gameAssets, smoke] = await Promise.all([doAndCount(loadAtlas(gl, \"./assets/eyemiru.atlas\")), doAndCount(loadTexture(gl, \"./assets/smoke.atlas\"))]);\n  let assets = {\n    gameAssets,\n    smoke\n  };\n  Game.assets = assets;\n  Game.setCurrentScreen(await createInstructionScreenSystem(Game));\n  gl.clearColor(1, 1, 1, 1);\n\n  const update = delta => {\n    gl.clear(gl.COLOR_BUFFER_BIT);\n\n    if (Game.currentScreen) {\n      Game.currentScreen.update(delta);\n    }\n  };\n\n  createGameLoop(update);\n};\n\ninit();","map":{"version":3,"sources":["E:/game-project/eyemiru/src/index.js"],"names":["createGameLoop","createBatch","loadTexture","loadAtlas","createViewport","fillRect","createWhiteText","loadFontFile","createInstructionScreenSystem","init","canvas","document","getElementById","width","height","viewport","camera","getCamera","gl","getContext","batch","whiteTex","Game","score","setCurrentScreen","screen","currentScreen","destroy","foxLogo","LOGO_WIDTH","LOGO_HEIGHT","counter","numOfAssets","draw","setProjection","combined","begin","setColor","ratio","end","doAndCount","promise","then","result","gameAssets","smoke","Promise","all","assets","clearColor","update","delta","clear","COLOR_BUFFER_BIT"],"mappings":"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","sourcesContent":["import \"./index.css\";\nimport {\n  createGameLoop,\n  createBatch,\n  loadTexture,\n  loadAtlas,\n  createViewport,\n  fillRect,\n} from \"gdxjs\";\nimport createWhiteText from \"gl-white-texture\";\nimport loadFontFile from \"./utils/loadFontFile\";\nimport createInstructionScreenSystem from \"./screens/InstructionScreen\";\n\nconst init = async () => {\n  const canvas = document.getElementById(\"main\");\n  const width = 47;\n  const height = 100;\n  const viewport = createViewport(canvas, width, height);\n  const camera = viewport.getCamera();\n  const gl = viewport.getContext();\n  const batch = createBatch(gl);\n  const whiteTex = createWhiteText(gl);\n\n  const Game = {\n    score: 0,\n    width,\n    height,\n    canvas,\n    gl,\n    batch,\n    camera,\n    whiteTex,\n    viewport,\n    setCurrentScreen(screen) {\n      if (Game.currentScreen) {\n        Game.currentScreen.destroy();\n      }\n      Game.currentScreen = screen;\n    },\n  };\n\n  const foxLogo = await loadTexture(gl, \"./assets/logo.png\");\n  const LOGO_WIDTH = width / 1.8;\n  const LOGO_HEIGHT = (LOGO_WIDTH * foxLogo.height) / foxLogo.width;\n\n  let counter = 0;\n  const numOfAssets = 10;\n\n  const draw = () => {\n    batch.setProjection(camera.combined);\n    batch.begin();\n    batch.setColor(255 / 255, 114 / 255, 22 / 255, 1);\n    fillRect(batch, whiteTex, 0, 0, width, height);\n    batch.setColor(1, 1, 1, 1);\n    fillRect(\n      batch,\n      foxLogo,\n      width / 2 - LOGO_WIDTH / 2,\n      (height * 0.8) / 3,\n      LOGO_WIDTH,\n      LOGO_HEIGHT\n    );\n    batch.setColor(1, 1, 1, 1);\n    fillRect(\n      batch,\n      whiteTex,\n      width / 2 - width / (1.45 * 2),\n      (height * 2.5) / 4 - height / 50,\n      width / 1.45,\n      height / 25\n    );\n    batch.setColor(255 / 255, 114 / 255, 22 / 255, 1);\n    fillRect(\n      batch,\n      whiteTex,\n      width / 2 - width / 3,\n      (height * 2.5) / 4 - height / 60,\n      width / 1.5,\n      height / 30\n    );\n    batch.setColor(1, 1, 1, 1);\n    let ratio = counter / numOfAssets;\n    fillRect(\n      batch,\n      whiteTex,\n      width / 2 - width / (1.55 * 2),\n      (height * 2.5) / 4 - height / 80,\n      (width / 1.55) * ratio,\n      height / 40\n    );\n    batch.end();\n  };\n\n  const doAndCount = (promise) =>\n    promise.then((result) => {\n      // draw();\n      counter += 1;\n      return result;\n    });\n\n  const [gameAssets, smoke] = await Promise.all([\n    doAndCount(loadAtlas(gl, \"./assets/eyemiru.atlas\")),\n    doAndCount(loadTexture(gl, \"./assets/smoke.atlas\")),\n  ]);\n\n  let assets = {\n    gameAssets,\n    smoke,\n  };\n  Game.assets = assets;\n  Game.setCurrentScreen(await createInstructionScreenSystem(Game));\n\n  gl.clearColor(1, 1, 1, 1);\n  const update = (delta) => {\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    if (Game.currentScreen) {\n      Game.currentScreen.update(delta);\n    }\n  };\n\n  createGameLoop(update);\n};\n\ninit();\n"]},"metadata":{},"sourceType":"module"}