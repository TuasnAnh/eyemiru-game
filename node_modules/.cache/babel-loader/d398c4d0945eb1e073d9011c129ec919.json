{"ast":null,"code":"import{Vector2}from\"gdxjs\";var createBasketCollideSystem=function createBasketCollideSystem(){return{update:function update(delta,worldState,_ref){var width=_ref.width,height=_ref.height;var basketState=worldState.basketState,products=worldState.products,collection=worldState.collection,life=worldState.life,starList=worldState.starList;var got=false;for(var i=products.length-1;i>=0;i--){if(products[i].x>basketState.x-basketState.width/2&&products[i].x<basketState.x+basketState.width/2&&products[i].y>basketState.y-basketState.height*0.7&&products[i].y<basketState.y-basketState.height*0.3){if(!products[i].isFake&&!worldState.correctCatch){console.log(\"hit\");worldState.correctCatch=true;for(var j=0;j<collection.length;j++){if(collection[j].type===products[i].type&&!collection[j].enable&&!got){got=true;collection[j].enable=true;}}// 0: 1 star --- 1: 3 stars\nif(products[i].type===2){worldState.vitaminACounter=Math.min(5,worldState.vitaminACounter+=1);var time=0.3;var speedX=basketState.width/time;var scaleSpeed=(1-0)/(2/3*time);starList.push({type:0,stateTime:0,time:time,scale:0,scaleSpeed:scaleSpeed,speedX:speedX,accuX:0// value\n});}else{var stateTime=[0,0,0];var scale=[1,1,1];var _time=[Math.random()*(0.4-0.3)+0.3,Math.random()*(0.4-0.3)+0.3,Math.random()*(0.4-0.3)+0.3];var position=[new Vector2(basketState.x,basketState.y-basketState.height),new Vector2(basketState.x,basketState.y-basketState.height),new Vector2(basketState.x,basketState.y-basketState.height)];var target=[new Vector2(basketState.x-Math.random()*(width/3-width/7)+width/7,Math.random()*(height*6.5/8-height*5/8)+height*5/8),new Vector2(basketState.x-Math.random()*(width/20),Math.random()*(height*6.5/8-height*5/8)+height*5/8),new Vector2(basketState.x+Math.random()*(width/3-width/7)+width/7,Math.random()*(height*6.5/8-height*5/8)+height*5/8)];var speed=[];var _scaleSpeed=[];for(var _i=0;_i<_time.length;_i++){speed.push(target[_i].distance(position[_i])/_time[_i]);_scaleSpeed.push(1/_time[_i]);}starList.push({type:1,time:_time,scale:scale,stateTime:stateTime,position:position,target:target,speed:speed,scaleSpeed:_scaleSpeed});}products.splice(i,1);break;// if there is any one match => break the loop\n}//wrong catch\nif(products[i].isFake){console.log(\"miss\");life[worldState.lifeIndex].open=false;worldState.lifeIndex=Math.max(0,worldState.lifeIndex-=1);worldState.stunScreen.check=true;products.splice(i,1);}}}}};};export default createBasketCollideSystem;","map":{"version":3,"sources":["E:/game-project/eyemiru/src/systems/BasketCollideSystem.js"],"names":["Vector2","createBasketCollideSystem","update","delta","worldState","width","height","basketState","products","collection","life","starList","got","i","length","x","y","isFake","correctCatch","console","log","j","type","enable","vitaminACounter","Math","min","time","speedX","scaleSpeed","push","stateTime","scale","accuX","random","position","target","speed","distance","splice","lifeIndex","open","max","stunScreen","check"],"mappings":"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","sourcesContent":["import { Vector2 } from \"gdxjs\";\r\n\r\nconst createBasketCollideSystem = () => {\r\n  return {\r\n    update(delta, worldState, { width, height }) {\r\n      const { basketState, products, collection, life, starList } = worldState;\r\n\r\n      let got = false;\r\n      for (let i = products.length - 1; i >= 0; i--) {\r\n        if (\r\n          products[i].x > basketState.x - basketState.width / 2 &&\r\n          products[i].x < basketState.x + basketState.width / 2 &&\r\n          products[i].y > basketState.y - basketState.height * 0.7 &&\r\n          products[i].y < basketState.y - basketState.height * 0.3\r\n        ) {\r\n          if (!products[i].isFake && !worldState.correctCatch) {\r\n            console.log(\"hit\");\r\n            worldState.correctCatch = true;\r\n            for (let j = 0; j < collection.length; j++) {\r\n              if (\r\n                collection[j].type === products[i].type &&\r\n                !collection[j].enable &&\r\n                !got\r\n              ) {\r\n                got = true;\r\n                collection[j].enable = true;\r\n              }\r\n            }\r\n\r\n            // 0: 1 star --- 1: 3 stars\r\n            if (products[i].type === 2) {\r\n              worldState.vitaminACounter = Math.min(\r\n                5,\r\n                (worldState.vitaminACounter += 1)\r\n              );\r\n\r\n              const time = 0.3;\r\n              const speedX = basketState.width / time;\r\n              const scaleSpeed = (1 - 0) / ((2 / 3) * time);\r\n              starList.push({\r\n                type: 0,\r\n                stateTime: 0,\r\n                time,\r\n                scale: 0,\r\n                scaleSpeed,\r\n                speedX,\r\n                accuX: 0,\r\n                // value\r\n              });\r\n            } else {\r\n              const stateTime = [0, 0, 0];\r\n              const scale = [1, 1, 1];\r\n              const time = [\r\n                Math.random() * (0.4 - 0.3) + 0.3,\r\n                Math.random() * (0.4 - 0.3) + 0.3,\r\n                Math.random() * (0.4 - 0.3) + 0.3,\r\n              ];\r\n              const position = [\r\n                new Vector2(basketState.x, basketState.y - basketState.height),\r\n                new Vector2(basketState.x, basketState.y - basketState.height),\r\n                new Vector2(basketState.x, basketState.y - basketState.height),\r\n              ];\r\n              const target = [\r\n                new Vector2(\r\n                  basketState.x -\r\n                    Math.random() * (width / 3 - width / 7) +\r\n                    width / 7,\r\n                  Math.random() * ((height * 6.5) / 8 - (height * 5) / 8) +\r\n                    (height * 5) / 8\r\n                ),\r\n                new Vector2(\r\n                  basketState.x - Math.random() * (width / 20),\r\n                  Math.random() * ((height * 6.5) / 8 - (height * 5) / 8) +\r\n                    (height * 5) / 8\r\n                ),\r\n                new Vector2(\r\n                  basketState.x +\r\n                    Math.random() * (width / 3 - width / 7) +\r\n                    width / 7,\r\n                  Math.random() * ((height * 6.5) / 8 - (height * 5) / 8) +\r\n                    (height * 5) / 8\r\n                ),\r\n              ];\r\n\r\n              let speed = [];\r\n              let scaleSpeed = [];\r\n              for (let i = 0; i < time.length; i++) {\r\n                speed.push(target[i].distance(position[i]) / time[i]);\r\n                scaleSpeed.push(1 / time[i]);\r\n              }\r\n\r\n              starList.push({\r\n                type: 1,\r\n                time,\r\n                scale,\r\n                stateTime,\r\n                position,\r\n                target,\r\n                speed,\r\n                scaleSpeed,\r\n              });\r\n            }\r\n\r\n            products.splice(i, 1);\r\n            break; // if there is any one match => break the loop\r\n          }\r\n\r\n          //wrong catch\r\n          if (products[i].isFake) {\r\n            console.log(\"miss\");\r\n            life[worldState.lifeIndex].open = false;\r\n            worldState.lifeIndex = Math.max(0, (worldState.lifeIndex -= 1));\r\n            worldState.stunScreen.check = true;\r\n            products.splice(i, 1);\r\n          }\r\n        }\r\n      }\r\n    },\r\n  };\r\n};\r\n\r\nexport default createBasketCollideSystem;\r\n"]},"metadata":{},"sourceType":"module"}