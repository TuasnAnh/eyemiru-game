{"ast":null,"code":"import _regeneratorRuntime from\"E:\\\\game-project\\\\eyemiru\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\game-project\\\\eyemiru\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";// import ReactDOM from \"react-dom\";\n// import React from \"react\";\n// import LeaderBoard from \"../LeaderBoard\";\n// import axios from \"../../utils/axios\";\nimport{createViewportAwareInputHandler,Vector2}from\"gdxjs\";import createWorld from\"../utils/createWorld\";import{getProductInBasketTex,getProductTexture,getFakeProductTex}from\"../utils/getProduct\";import createLeaderBoardSystem from\"./LeaderBoardScreen\";import createBackGroundRenderSystem from\"../systems/BgRenderSystem\";import createBasketRenderSystem from\"../systems/BasketRenderSystem\";import createInputHandlerGameScreenSystem from\"../systems/InputHandlerGameScreenSystem\";import createBasketPositionSystem from\"../systems/BasketPositionSystem\";import createProductSpawnSystem from\"../systems/ProductSpawnSystem\";import createProductPositionSystem from\"../systems/ProductPositionSystem\";import createProductRenderSystem from\"../systems/ProductRenderSystem\";import createBasketCollideSystem from\"../systems/BasketCollideSystem\";import createScoreCalcSystem from\"../systems/ScoreCaculateSystem\";import createLifeRenderSystem from\"../systems/LifeRenderSystem\";import createStarEffectRenderSystem from\"../systems/StarEffectRenderSystem\";import createStunScreenRenderSystem from\"../systems/StunScreenSystem\";import createWhiteSmokeRenderSystem from\"../systems/WhiteSmokeRenderSystem\";import createVitaminARenderSystem from\"../systems/VitaminARenderSystem\";import createScoreRenderSystem from\"../systems/ScoreRenderSystem\";var createGameScreenSystem=function createGameScreenSystem(Game){var width=Game.width,height=Game.height,canvas=Game.canvas,gl=Game.gl,batch=Game.batch,camera=Game.camera,whiteTex=Game.whiteTex,assets=Game.assets,viewport=Game.viewport,font=Game.font;var inputHandler=createViewportAwareInputHandler(canvas,viewport);var BASKET_INITIAL_Y=height*3.65/4;var basketBack=assets.gameAssets.findRegion(\"basket_back\",-1);var BASKET_WIDTH=width/3.8;var BASKET_BACK_HEIGHT=BASKET_WIDTH*basketBack.height/basketBack.width;var productTex=getProductTexture(assets.gameAssets);var fakeProductTex=getFakeProductTex(assets.gameAssets);var productInBasketTex=getProductInBasketTex(assets.gameAssets);var worldState={score:0,correctCatch:false,stateTime:0,gameOver:false,emptyLife:false,life:[{open:true},{open:true},{open:true}],lifeIndex:2,// life checking index\nbasketState:{x:width/2,y:BASKET_INITIAL_Y,width:BASKET_WIDTH,height:BASKET_BACK_HEIGHT,position:new Vector2(width/2,BASKET_INITIAL_Y),target:new Vector2(width/2,BASKET_INITIAL_Y),speed:width*2.5},difficulty:1,collection:[{type:0,enable:false},{type:0,enable:false},{type:1,enable:false}],collectionFinished:[],products:[],productInfos:{accY:height/2},starList:[],whiteSmokeList:[],stunScreen:{check:false,opacity:1},vitaminACounter:0};var extra={canvas:canvas,width:width,height:height,gl:gl,batch:batch,camera:camera,whiteTex:whiteTex,inputHandler:inputHandler,assets:assets,productTex:productTex,fakeProductTex:fakeProductTex,productInBasketTex:productInBasketTex,font:font};var world=createWorld(worldState,extra);world.addSystem(createInputHandlerGameScreenSystem());world.addSystem(createBasketPositionSystem());world.addSystem(createProductSpawnSystem());world.addSystem(createProductPositionSystem());world.addSystem(createBasketCollideSystem());world.addSystem(createScoreCalcSystem());world.addSystem(createBackGroundRenderSystem());world.addSystem(createBasketRenderSystem());world.addSystem(createProductRenderSystem());world.addSystem(createScoreRenderSystem());world.addSystem(createLifeRenderSystem());world.addSystem(createVitaminARenderSystem());world.addSystem(createStarEffectRenderSystem());world.addSystem(createWhiteSmokeRenderSystem());world.addSystem(createStunScreenRenderSystem());var goToLeaderBoardScreen=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=Game;_context.next=3;return createLeaderBoardSystem(Game);case 3:_context.t1=_context.sent;_context.t0.setCurrentScreen.call(_context.t0,_context.t1);case 5:case\"end\":return _context.stop();}}},_callee);}));return function goToLeaderBoardScreen(){return _ref.apply(this,arguments);};}();var update=function update(delta){if(!worldState.gameOver){worldState.stateTime+=delta;world.update(delta);}else{goToLeaderBoardScreen();}};return{update:update,destroy:function destroy(){inputHandler.cleanup();}};};export default createGameScreenSystem;","map":{"version":3,"sources":["E:/game-project/eyemiru/src/screens/GameScreen.js"],"names":["createViewportAwareInputHandler","Vector2","createWorld","getProductInBasketTex","getProductTexture","getFakeProductTex","createLeaderBoardSystem","createBackGroundRenderSystem","createBasketRenderSystem","createInputHandlerGameScreenSystem","createBasketPositionSystem","createProductSpawnSystem","createProductPositionSystem","createProductRenderSystem","createBasketCollideSystem","createScoreCalcSystem","createLifeRenderSystem","createStarEffectRenderSystem","createStunScreenRenderSystem","createWhiteSmokeRenderSystem","createVitaminARenderSystem","createScoreRenderSystem","createGameScreenSystem","Game","width","height","canvas","gl","batch","camera","whiteTex","assets","viewport","font","inputHandler","BASKET_INITIAL_Y","basketBack","gameAssets","findRegion","BASKET_WIDTH","BASKET_BACK_HEIGHT","productTex","fakeProductTex","productInBasketTex","worldState","score","correctCatch","stateTime","gameOver","emptyLife","life","open","lifeIndex","basketState","x","y","position","target","speed","difficulty","collection","type","enable","collectionFinished","products","productInfos","accY","starList","whiteSmokeList","stunScreen","check","opacity","vitaminACounter","extra","world","addSystem","goToLeaderBoardScreen","setCurrentScreen","update","delta","destroy","cleanup"],"mappings":"uSAAA;AACA;AACA;AACA;AAEA,OAASA,+BAAT,CAA0CC,OAA1C,KAAyD,OAAzD,CACA,MAAOC,CAAAA,WAAP,KAAwB,sBAAxB,CACA,OACEC,qBADF,CAEEC,iBAFF,CAGEC,iBAHF,KAIO,qBAJP,CAKA,MAAOC,CAAAA,uBAAP,KAAoC,qBAApC,CACA,MAAOC,CAAAA,4BAAP,KAAyC,2BAAzC,CACA,MAAOC,CAAAA,wBAAP,KAAqC,+BAArC,CACA,MAAOC,CAAAA,kCAAP,KAA+C,yCAA/C,CACA,MAAOC,CAAAA,0BAAP,KAAuC,iCAAvC,CACA,MAAOC,CAAAA,wBAAP,KAAqC,+BAArC,CACA,MAAOC,CAAAA,2BAAP,KAAwC,kCAAxC,CACA,MAAOC,CAAAA,yBAAP,KAAsC,gCAAtC,CACA,MAAOC,CAAAA,yBAAP,KAAsC,gCAAtC,CACA,MAAOC,CAAAA,qBAAP,KAAkC,gCAAlC,CACA,MAAOC,CAAAA,sBAAP,KAAmC,6BAAnC,CACA,MAAOC,CAAAA,4BAAP,KAAyC,mCAAzC,CACA,MAAOC,CAAAA,4BAAP,KAAyC,6BAAzC,CACA,MAAOC,CAAAA,4BAAP,KAAyC,mCAAzC,CACA,MAAOC,CAAAA,0BAAP,KAAuC,iCAAvC,CACA,MAAOC,CAAAA,uBAAP,KAAoC,8BAApC,CAEA,GAAMC,CAAAA,sBAAsB,CAAG,QAAzBA,CAAAA,sBAAyB,CAACC,IAAD,CAAU,IAErCC,CAAAA,KAFqC,CAYnCD,IAZmC,CAErCC,KAFqC,CAGrCC,MAHqC,CAYnCF,IAZmC,CAGrCE,MAHqC,CAIrCC,MAJqC,CAYnCH,IAZmC,CAIrCG,MAJqC,CAKrCC,EALqC,CAYnCJ,IAZmC,CAKrCI,EALqC,CAMrCC,KANqC,CAYnCL,IAZmC,CAMrCK,KANqC,CAOrCC,MAPqC,CAYnCN,IAZmC,CAOrCM,MAPqC,CAQrCC,QARqC,CAYnCP,IAZmC,CAQrCO,QARqC,CASrCC,MATqC,CAYnCR,IAZmC,CASrCQ,MATqC,CAUrCC,QAVqC,CAYnCT,IAZmC,CAUrCS,QAVqC,CAWrCC,IAXqC,CAYnCV,IAZmC,CAWrCU,IAXqC,CAcvC,GAAMC,CAAAA,YAAY,CAAGlC,+BAA+B,CAAC0B,MAAD,CAASM,QAAT,CAApD,CACA,GAAMG,CAAAA,gBAAgB,CAAIV,MAAM,CAAG,IAAV,CAAkB,CAA3C,CAEA,GAAMW,CAAAA,UAAU,CAAGL,MAAM,CAACM,UAAP,CAAkBC,UAAlB,CAA6B,aAA7B,CAA4C,CAAC,CAA7C,CAAnB,CACA,GAAMC,CAAAA,YAAY,CAAGf,KAAK,CAAG,GAA7B,CACA,GAAMgB,CAAAA,kBAAkB,CACrBD,YAAY,CAAGH,UAAU,CAACX,MAA3B,CAAqCW,UAAU,CAACZ,KADlD,CAGA,GAAMiB,CAAAA,UAAU,CAAGrC,iBAAiB,CAAC2B,MAAM,CAACM,UAAR,CAApC,CACA,GAAMK,CAAAA,cAAc,CAAGrC,iBAAiB,CAAC0B,MAAM,CAACM,UAAR,CAAxC,CACA,GAAMM,CAAAA,kBAAkB,CAAGxC,qBAAqB,CAAC4B,MAAM,CAACM,UAAR,CAAhD,CAEA,GAAMO,CAAAA,UAAU,CAAG,CACjBC,KAAK,CAAE,CADU,CAEjBC,YAAY,CAAE,KAFG,CAGjBC,SAAS,CAAE,CAHM,CAIjBC,QAAQ,CAAE,KAJO,CAKjBC,SAAS,CAAE,KALM,CAMjBC,IAAI,CAAE,CAAC,CAAEC,IAAI,CAAE,IAAR,CAAD,CAAiB,CAAEA,IAAI,CAAE,IAAR,CAAjB,CAAiC,CAAEA,IAAI,CAAE,IAAR,CAAjC,CANW,CAOjBC,SAAS,CAAE,CAPM,CAOH;AACdC,WAAW,CAAE,CACXC,CAAC,CAAE9B,KAAK,CAAG,CADA,CAEX+B,CAAC,CAAEpB,gBAFQ,CAGXX,KAAK,CAAEe,YAHI,CAIXd,MAAM,CAAEe,kBAJG,CAKXgB,QAAQ,CAAE,GAAIvD,CAAAA,OAAJ,CAAYuB,KAAK,CAAG,CAApB,CAAuBW,gBAAvB,CALC,CAMXsB,MAAM,CAAE,GAAIxD,CAAAA,OAAJ,CAAYuB,KAAK,CAAG,CAApB,CAAuBW,gBAAvB,CANG,CAOXuB,KAAK,CAAElC,KAAK,CAAG,GAPJ,CARI,CAiBjBmC,UAAU,CAAE,CAjBK,CAkBjBC,UAAU,CAAE,CACV,CAAEC,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,KAAnB,CADU,CAEV,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,KAAnB,CAFU,CAGV,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,KAAnB,CAHU,CAlBK,CAuBjBC,kBAAkB,CAAE,EAvBH,CAwBjBC,QAAQ,CAAE,EAxBO,CAyBjBC,YAAY,CAAE,CACZC,IAAI,CAAEzC,MAAM,CAAG,CADH,CAzBG,CA4BjB0C,QAAQ,CAAE,EA5BO,CA6BjBC,cAAc,CAAE,EA7BC,CA8BjBC,UAAU,CAAE,CAAEC,KAAK,CAAE,KAAT,CAAgBC,OAAO,CAAE,CAAzB,CA9BK,CA+BjBC,eAAe,CAAE,CA/BA,CAAnB,CAkCA,GAAMC,CAAAA,KAAK,CAAG,CACZ/C,MAAM,CAANA,MADY,CAEZF,KAAK,CAALA,KAFY,CAGZC,MAAM,CAANA,MAHY,CAIZE,EAAE,CAAFA,EAJY,CAKZC,KAAK,CAALA,KALY,CAMZC,MAAM,CAANA,MANY,CAOZC,QAAQ,CAARA,QAPY,CAQZI,YAAY,CAAZA,YARY,CASZH,MAAM,CAANA,MATY,CAUZU,UAAU,CAAVA,UAVY,CAWZC,cAAc,CAAdA,cAXY,CAYZC,kBAAkB,CAAlBA,kBAZY,CAaZV,IAAI,CAAJA,IAbY,CAAd,CAeA,GAAMyC,CAAAA,KAAK,CAAGxE,WAAW,CAAC0C,UAAD,CAAa6B,KAAb,CAAzB,CAEAC,KAAK,CAACC,SAAN,CAAgBlE,kCAAkC,EAAlD,EACAiE,KAAK,CAACC,SAAN,CAAgBjE,0BAA0B,EAA1C,EACAgE,KAAK,CAACC,SAAN,CAAgBhE,wBAAwB,EAAxC,EACA+D,KAAK,CAACC,SAAN,CAAgB/D,2BAA2B,EAA3C,EACA8D,KAAK,CAACC,SAAN,CAAgB7D,yBAAyB,EAAzC,EACA4D,KAAK,CAACC,SAAN,CAAgB5D,qBAAqB,EAArC,EAEA2D,KAAK,CAACC,SAAN,CAAgBpE,4BAA4B,EAA5C,EACAmE,KAAK,CAACC,SAAN,CAAgBnE,wBAAwB,EAAxC,EACAkE,KAAK,CAACC,SAAN,CAAgB9D,yBAAyB,EAAzC,EACA6D,KAAK,CAACC,SAAN,CAAgBtD,uBAAuB,EAAvC,EACAqD,KAAK,CAACC,SAAN,CAAgB3D,sBAAsB,EAAtC,EACA0D,KAAK,CAACC,SAAN,CAAgBvD,0BAA0B,EAA1C,EACAsD,KAAK,CAACC,SAAN,CAAgB1D,4BAA4B,EAA5C,EACAyD,KAAK,CAACC,SAAN,CAAgBxD,4BAA4B,EAA5C,EAEAuD,KAAK,CAACC,SAAN,CAAgBzD,4BAA4B,EAA5C,EAEA,GAAM0D,CAAAA,qBAAqB,0FAAG,+IAC5BrD,IAD4B,uBACAjB,CAAAA,uBAAuB,CAACiB,IAAD,CADvB,8CACvBsD,gBADuB,qFAAH,kBAArBD,CAAAA,qBAAqB,0CAA3B,CAIA,GAAME,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAACC,KAAD,CAAW,CACxB,GAAI,CAACnC,UAAU,CAACI,QAAhB,CAA0B,CACxBJ,UAAU,CAACG,SAAX,EAAwBgC,KAAxB,CACAL,KAAK,CAACI,MAAN,CAAaC,KAAb,EACD,CAHD,IAGO,CACLH,qBAAqB,GACtB,CACF,CAPD,CASA,MAAO,CACLE,MAAM,CAANA,MADK,CAELE,OAFK,mBAEK,CACR9C,YAAY,CAAC+C,OAAb,GACD,CAJI,CAAP,CAMD,CAlHD,CAoHA,cAAe3D,CAAAA,sBAAf","sourcesContent":["// import ReactDOM from \"react-dom\";\r\n// import React from \"react\";\r\n// import LeaderBoard from \"../LeaderBoard\";\r\n// import axios from \"../../utils/axios\";\r\n\r\nimport { createViewportAwareInputHandler, Vector2 } from \"gdxjs\";\r\nimport createWorld from \"../utils/createWorld\";\r\nimport {\r\n  getProductInBasketTex,\r\n  getProductTexture,\r\n  getFakeProductTex,\r\n} from \"../utils/getProduct\";\r\nimport createLeaderBoardSystem from \"./LeaderBoardScreen\";\r\nimport createBackGroundRenderSystem from \"../systems/BgRenderSystem\";\r\nimport createBasketRenderSystem from \"../systems/BasketRenderSystem\";\r\nimport createInputHandlerGameScreenSystem from \"../systems/InputHandlerGameScreenSystem\";\r\nimport createBasketPositionSystem from \"../systems/BasketPositionSystem\";\r\nimport createProductSpawnSystem from \"../systems/ProductSpawnSystem\";\r\nimport createProductPositionSystem from \"../systems/ProductPositionSystem\";\r\nimport createProductRenderSystem from \"../systems/ProductRenderSystem\";\r\nimport createBasketCollideSystem from \"../systems/BasketCollideSystem\";\r\nimport createScoreCalcSystem from \"../systems/ScoreCaculateSystem\";\r\nimport createLifeRenderSystem from \"../systems/LifeRenderSystem\";\r\nimport createStarEffectRenderSystem from \"../systems/StarEffectRenderSystem\";\r\nimport createStunScreenRenderSystem from \"../systems/StunScreenSystem\";\r\nimport createWhiteSmokeRenderSystem from \"../systems/WhiteSmokeRenderSystem\";\r\nimport createVitaminARenderSystem from \"../systems/VitaminARenderSystem\";\r\nimport createScoreRenderSystem from \"../systems/ScoreRenderSystem\";\r\n\r\nconst createGameScreenSystem = (Game) => {\r\n  const {\r\n    width,\r\n    height,\r\n    canvas,\r\n    gl,\r\n    batch,\r\n    camera,\r\n    whiteTex,\r\n    assets,\r\n    viewport,\r\n    font,\r\n  } = Game;\r\n\r\n  const inputHandler = createViewportAwareInputHandler(canvas, viewport);\r\n  const BASKET_INITIAL_Y = (height * 3.65) / 4;\r\n\r\n  const basketBack = assets.gameAssets.findRegion(\"basket_back\", -1);\r\n  const BASKET_WIDTH = width / 3.8;\r\n  const BASKET_BACK_HEIGHT =\r\n    (BASKET_WIDTH * basketBack.height) / basketBack.width;\r\n\r\n  const productTex = getProductTexture(assets.gameAssets);\r\n  const fakeProductTex = getFakeProductTex(assets.gameAssets);\r\n  const productInBasketTex = getProductInBasketTex(assets.gameAssets);\r\n\r\n  const worldState = {\r\n    score: 0,\r\n    correctCatch: false,\r\n    stateTime: 0,\r\n    gameOver: false,\r\n    emptyLife: false,\r\n    life: [{ open: true }, { open: true }, { open: true }],\r\n    lifeIndex: 2, // life checking index\r\n    basketState: {\r\n      x: width / 2,\r\n      y: BASKET_INITIAL_Y,\r\n      width: BASKET_WIDTH,\r\n      height: BASKET_BACK_HEIGHT,\r\n      position: new Vector2(width / 2, BASKET_INITIAL_Y),\r\n      target: new Vector2(width / 2, BASKET_INITIAL_Y),\r\n      speed: width * 2.5,\r\n    },\r\n    difficulty: 1,\r\n    collection: [\r\n      { type: 0, enable: false },\r\n      { type: 0, enable: false },\r\n      { type: 1, enable: false },\r\n    ],\r\n    collectionFinished: [],\r\n    products: [],\r\n    productInfos: {\r\n      accY: height / 2,\r\n    },\r\n    starList: [],\r\n    whiteSmokeList: [],\r\n    stunScreen: { check: false, opacity: 1 },\r\n    vitaminACounter: 0,\r\n  };\r\n\r\n  const extra = {\r\n    canvas,\r\n    width,\r\n    height,\r\n    gl,\r\n    batch,\r\n    camera,\r\n    whiteTex,\r\n    inputHandler,\r\n    assets,\r\n    productTex,\r\n    fakeProductTex,\r\n    productInBasketTex,\r\n    font,\r\n  };\r\n  const world = createWorld(worldState, extra);\r\n\r\n  world.addSystem(createInputHandlerGameScreenSystem());\r\n  world.addSystem(createBasketPositionSystem());\r\n  world.addSystem(createProductSpawnSystem());\r\n  world.addSystem(createProductPositionSystem());\r\n  world.addSystem(createBasketCollideSystem());\r\n  world.addSystem(createScoreCalcSystem());\r\n\r\n  world.addSystem(createBackGroundRenderSystem());\r\n  world.addSystem(createBasketRenderSystem());\r\n  world.addSystem(createProductRenderSystem());\r\n  world.addSystem(createScoreRenderSystem());\r\n  world.addSystem(createLifeRenderSystem());\r\n  world.addSystem(createVitaminARenderSystem());\r\n  world.addSystem(createStarEffectRenderSystem());\r\n  world.addSystem(createWhiteSmokeRenderSystem());\r\n\r\n  world.addSystem(createStunScreenRenderSystem());\r\n\r\n  const goToLeaderBoardScreen = async () => {\r\n    Game.setCurrentScreen(await createLeaderBoardSystem(Game));\r\n  };\r\n\r\n  const update = (delta) => {\r\n    if (!worldState.gameOver) {\r\n      worldState.stateTime += delta;\r\n      world.update(delta);\r\n    } else {\r\n      goToLeaderBoardScreen();\r\n    }\r\n  };\r\n\r\n  return {\r\n    update,\r\n    destroy() {\r\n      inputHandler.cleanup();\r\n    },\r\n  };\r\n};\r\n\r\nexport default createGameScreenSystem;\r\n"]},"metadata":{},"sourceType":"module"}